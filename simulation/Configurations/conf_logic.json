{
    "workstations": [
        { "hostname": "router", "actions": [
                                                    {"name":"install", "args": {"module":"iptables"} },
                                                    {"name":"execute_command", "args": {"command":["iptables", "-t", "nat", "-A", "POSTROUTING", "-o", "eth3", "-j", "MASQUERADE"], "expected_exit_code":"0"} },
                                                    {"name":"add_nameserver", "args": {"nameserver_ip":"8.8.8.8"} },
                                                    {"name":"install", "args": {"module":"nmap"} },
                                                    {"name":"suricata_installation", "args": {"":""} },
                                                    {"name":"rsyslog_client", "args": {"ip_log_server":"10.122.1.11","log_files":["authentication","suricata"]} }
                                                    ] },
        { "hostname": "chat", "actions": [
                                                    {"name":"install", "args": {"module":"firefox"} },
                                                    {"name":"install_chat_application", "args": {"":""} },
                                                    {"name":"add_nameserver", "args": {"nameserver_ip":"10.122.0.14"} },
                                                    {"name":"rsyslog_client", "args": {"ip_log_server":"10.122.1.11","log_files":["authentication","apache2"]} }
                                                    ] },
        { "hostname": "social", "actions": [
                                                    {"name":"install", "args": {"module":"nano"} },
                                                    {"name":"install_gnu_social_network", "args": {"server_ip":"10.122.0.22", "domain_name":"social.com"} },
                                                    {"name":"add_nameserver", "args": {"nameserver_ip":"10.122.0.14"} },
                                                    {"name":"rsyslog_client", "args": {"ip_log_server":"10.122.1.11","log_files":["authentication","apache2"]} }
                                                    ] },
        { "hostname": "dns", "actions": [
                                                    {"name":"generate_root_ca", "args": {"private_key_ca_certificate_name":"caroot.com","bits":"2048","version":"2","serial":"","C":"FR","ST":"France","L":"Paris","O":"carootemission","CN":"caroot.com","days_validity":"360"} },
                                                    {"name":"generate_middle_certificates", "args": {"ca_holder":"dns","ca_name":"caroot.com","private_key_middle_certificate_name":"silicom.com","bits":"2048","version":"2","serial":"","C":"FR","ST":"France","L":"Guyancourt","O":"Silicom","CN":"silicom.coml","days_validity":"360"} },
                                                    {"name":"generate_middle_certificates", "args": {"ca_holder":"dns","ca_name":"caroot.com","private_key_middle_certificate_name":"filial1.caroot.com","bits":"2048","version":"2","serial":"","C":"FR","ST":"France","L":"Paris","O":"caroot","CN":"fillial1.caroot.com","days_validity":"360"} },
                                                    {"name":"dns_installation", "args": {"domain_name":"dns.silicom.com","ip_resolution":"10.122.1.14"} },
                                                    {"name":"dns_resolve_name", "args": {"domain_name": "dvwa.silicom.com",
                                                                                         "ip_resolution":"10.122.1.15",
                                                                                         "mail":"",
                                                                                         "alias":["www"]} },
                                                    {"name":"dns_resolve_name", "args": {"domain_name": "mail.silicom.com",
                                                                                         "ip_resolution":"10.122.1.12",
                                                                                         "mail":"true",
                                                                                         "alias":["smtp","imap"]} },
                                                    {"name":"dns_resolve_name", "args": {"domain_name": "silicom.com",
                                                                                         "ip_resolution":"10.122.1.10",
                                                                                         "mail":"",
                                                                                         "alias":["ldap"]} },
                                                    {"name":"dns_resolve_name", "args": {"domain_name": "samba.silicom.com",
                                                                                         "ip_resolution":"10.122.1.17",
                                                                                         "mail":"",
                                                                                         "alias":[""]} },
                                                    {"name":"dns_resolve_name", "args": {"domain_name": "chat.com",
                                                                                         "ip_resolution":"10.122.1.21",
                                                                                         "mail":"",
                                                                                         "alias":["www"]} },
                                                    {"name":"dns_resolve_name", "args": {"domain_name": "social.com",
                                                                                         "ip_resolution":"10.122.1.22",
                                                                                         "mail":"",
                                                                                         "alias":["www"]} },
                                                    {"name":"add_nameserver", "args": {"nameserver_ip":"10.122.0.14"} }
                                                    ] }, 
        { "hostname": "ldap", "actions": [
                                                    {"name":"generate_certificates", "args": {"ca_holder":"dns","ca_name":"caroot.com","middle_holder":"dns","middle_name":"silicom.com","private_key_certificate_name":"ldap.silicom.com","bits":"2048","version":"2","serial":"","C":"FR","ST":"France","L":"Guyancourt","O":"Silicom","CN":"*.ldap.silicom.com","days_validity":"360","dns":"ldap.silicom.com"} },
                                                    {"name":"ldap_create_domaine","args": {"root_password":"admin123" ,
                                                                                            "domaine_name":"silicom.com",
                                                                                            "domain":"dc=silicom,dc=com",
                                                                                            "organization":"Silicom",
                                                                                            "ip_log_server":"10.122.1.11"} },
                                                    {"name":"ldap_add_user", "args": {"hostname":"ldap_server", 
                                                                                        "username":"tgourmelen",
                                                                                        "objectClass":["top", "inetOrgPerson", "posixAccount"], 
                                                                                        "mail":"tgourmelen@silicom.com",
                                                                                        "sn":"Gourmelen",
                                                                                        "dn":"uid=tgourmelen,dc=silicom,dc=com",
                                                                                        "domain":"dc=silicom,dc=com",
                                                                                        "homeDirectory":"/home/tgourmelen",
                                                                                        "loginShell":"/bin/bash",
                                                                                        "password":"tgourmelen123",
                                                                                        "uidNumber":"1501",
                                                                                        "gidNumber":"101"} },
                                                    {"name":"ldap_add_user", "args": {"hostname":"ldap_server", 
                                                                                        "username":"cyrus",
                                                                                        "objectClass":["inetOrgPerson"], 
                                                                                        "mail":"",
                                                                                        "sn":"Cyrus",
                                                                                        "dn":"uid=cyrus,dc=silicom,dc=com",
                                                                                        "domain":"dc=silicom,dc=com",
                                                                                        "homeDirectory":"",
                                                                                        "loginShell":"",
                                                                                        "password":"cyrus123",
                                                                                        "uidNumber":"",
                                                                                        "gidNumber":""} },
                                                    {"name":"ldap_add_user", "args": {"hostname":"ldap_server", 
                                                                                        "username":"aquemat",
                                                                                        "objectClass":["top", "inetOrgPerson", "posixAccount"], 
                                                                                        "mail":"aquemat@silicom.com",
                                                                                        "sn":"Quemat",
                                                                                        "dn":"uid=aquemat,dc=silicom,dc=com",
                                                                                        "domain":"dc=silicom,dc=com",
                                                                                        "homeDirectory":"/home/aquemat",
                                                                                        "loginShell":"/bin/bash",
                                                                                        "password":"aquemat123",
                                                                                        "uidNumber":"1502",
                                                                                        "gidNumber":"102"} },
                                                    {"name":"ldap_add_user", "args": {"hostname":"ldap_server", 
                                                                                        "username":"ogesny",
                                                                                        "objectClass":["top", "inetOrgPerson", "posixAccount"], 
                                                                                        "mail":"ogesny@silicom.com",
                                                                                        "sn":"Gesny",
                                                                                        "dn":"uid=ogesny,dc=silicom,dc=com",
                                                                                        "domain":"dc=silicom,dc=com",
                                                                                        "homeDirectory":"/home/ogesny",
                                                                                        "loginShell":"/bin/bash",
                                                                                        "password":"ogesny123",
                                                                                        "uidNumber":"1502",
                                                                                        "gidNumber":"102"} },
                                                    {"name":"ldap_add_user", "args": {"hostname":"ldap_server", 
                                                                                        "username":"pdelesques",
                                                                                        "objectClass":["top", "inetOrgPerson", "posixAccount"], 
                                                                                        "mail":"pdelesques@silicom.com",
                                                                                        "sn":"Pdelesques",
                                                                                        "dn":"uid=pdelesques,dc=silicom,dc=com",
                                                                                        "domain":"dc=silicom,dc=com",
                                                                                        "homeDirectory":"/home/pdelesques",
                                                                                        "loginShell":"/bin/bash",
                                                                                        "password":"pdelesques123",
                                                                                        "uidNumber":"1502",
                                                                                        "gidNumber":"102"} },
                                                    {"name":"add_nameserver", "args": {"nameserver_ip":"10.122.0.14"} },
                                                    {"name":"rsyslog_client", "args": {"ip_log_server":"10.122.1.11","log_files":["ldap"]} }
                                    
                                                    ] },
        { "hostname": "mail", "actions": [
                                                    {"name":"generate_certificates", "args": {"ca_holder":"dns","ca_name":"caroot.com","middle_holder":"dns","middle_name":"silicom.com","private_key_certificate_name":"imap.mail.silicom.com","bits":"2048","version":"2","serial":"","C":"FR","ST":"France","L":"Guyancourt","O":"Silicom","CN":"*.imap.mail.silicom.com","days_validity":"360","dns":"imap.mail.silicom.com"} },
                                                    {"name":"generate_certificates", "args": {"ca_holder":"dns","ca_name":"caroot.com","middle_holder":"dns","middle_name":"silicom.com","private_key_certificate_name":"smtp.mail.silicom.com","bits":"2048","version":"2","serial":"","C":"FR","ST":"France","L":"Guyancourt","O":"Silicom","CN":"*.smtp.mail.silicom.com","days_validity":"360","dns":"smtp.mail.silicom.com"} },
                                                    {"name":"ldap_client_config", "args": {"ldap_ip":"10.122.1.10", 
                                                                                        "base":"dc=silicom,dc=com", 
                                                                                        "uri":"uri ldap://silicom.com/", 
                                                                                        "ldap_admin":"cn=admin,dc=silicom,dc=com"} },
                                                    {"name":"mail_installation", "args": {"ldap_ip":"10.122.1.10", 
                                                                                        "ldap_domain":"silicom.com",
                                                                                        "ldap_dn":"dc=silicom,dc=com", 
                                                                                        "ldap_manager":"cn=admin,dc=silicom,dc=com", 
                                                                                        "ldap_manager_password":"admin123",
                                                                                        "ldap_port":"389",
                                                                                        "domain_name":"silicom.com",
                                                                                        "users_mailbox":["aquemat", "tgourmelen","ogesny","pdelesques"]} },
                                                    {"name":"enable_ssl_imapd", "args": {"cert_path":"/certs/imap.mail.silicom.com/imap.mail.silicom.com.cert","key_path":"/certs/imap.mail.silicom.com/imap.mail.silicom.com.key","ca_dir":"/certs/imap.mail.silicom.com/","cas_path":["/certs/imap.mail.silicom.com/caroot.com.cert","/certs/imap.mail.silicom.com/silicom.com.cert"]} },
                                                    {"name":"enable_ssl_postfix", "args": {"cert_path":"/certs/smtp.mail.silicom.com/smtp.mail.silicom.com.cert","key_path":"/certs/smtp.mail.silicom.com/smtp.mail.silicom.com.key","ca_dir":"/certs/smtp.mail.silicom.com/","cas_path":["/certs/smtp.mail.silicom.com/caroot.com.cert","/certs/smtp.mail.silicom.com/silicom.com.cert"]} },
                                                    {"name":"fail2ban_installation_configuration", "args": {"services":[{"name":"cyrus-imap", "bantime":"30m", "findtime":"5m", "maxretry":"3"}]} },
                                                    {"name":"rsyslog_client", "args": {"ip_log_server":"10.122.1.11","log_files":["mail","authentication"]} },
                                                    {"name":"add_nameserver", "args": {"nameserver_ip":"10.122.0.14"} }
                                                    ] },
        { "hostname": "dvwa", "actions": [
                                                    {"name":"add_nameserver", "args": {"nameserver_ip":"8.8.8.8"} },
                                                    {"name":"create_local_user", "args": {"username":"dvwa_user","password":"dvwa_user123"} },
                                                    {"name":"install", "args": {"module":"firefox"} },
                                                    {"name":"generate_certificates", "args": {"ca_holder":"dns","ca_name":"caroot.com","middle_holder":"dns","middle_name":"silicom.com","private_key_certificate_name":"dvwa.silicom.com","bits":"2048","version":"2","serial":"","C":"FR","ST":"France","L":"Guyancourt","O":"Silicom","CN":"*.dvwa.silicom.com","days_validity":"360","dns":"dvwa.silicom.com"} },
                                                    {"name":"install_dvwa"},
                                                    {"name":"configure_iptables", "args": {"":""} },
                                                    {"name":"rsyslog_client", "args": {"ip_log_server":"10.122.1.11","log_files":["authentication","apache2"]} }
                                                    ] },
        { "hostname": "samba", "actions": [
                                                    {"name":"add_nameserver", "args": {"nameserver_ip":"8.8.8.8"} },
                                                    {"name":"install_samba", "args": {"":""} },
                                                    {"name":"add_share_file", "args": {"share_file_name":"shareFile","comment":"Fichier partage silicom!",
                                                                                      "private":"true","browseable":"yes","writable":"yes","valid_users":["aquemat","tgourmelen","pdelesques","ogesny"],
                                                                                      "users":[["aquemat","aquemat123"],["tgourmelen","tgourmelen123"],["pdelesques","pdelesques123"],["ogesny","ogesny123"]]} },
                                                    {"name":"fail2ban_installation_configuration", "args": {"services":[{"name":"samba", "bantime":"30m", "findtime":"5m", "maxretry":"3"}]} },
                                                    {"name":"rsyslog_client", "args": {"ip_log_server":"10.122.1.11","log_files":["samba","authentication"]} }
                                                    ] },
        { "hostname": "camera", "actions": [
                                                    {"name":"generate_certificates", "args": {"ca_holder":"dns","ca_name":"caroot.com","middle_holder":"dns","middle_name":"silicom.com","private_key_certificate_name":"camera1.silicom.com","bits":"2048","version":"2","serial":"","C":"FR","ST":"France","L":"Guyancourt","O":"Silicom","CN":"*.camera1.silicom.com","days_validity":"360","dns":"camera1.silicom.com"} },
                                                    {"name":"install_virtual_camera", "args": {"video_url": "https://www.c-mor.com/video-surveillance-demo/sample-recordings-of-the-video-surveillance-system-c-mor?download=26:motion-detection-computer-room"}},
                                                    {"name":"install_motion", "args": {"motion_port":"8081", "security":{}}}
                                                    ] },
        { "hostname": "camera2", "actions": [
                                                    {"name":"generate_certificates", "args": {"ca_holder":"dns","ca_name":"caroot.com","middle_holder":"dns","middle_name":"silicom.com","private_key_certificate_name":"camera2.silicom.com","bits":"2048","version":"2","serial":"","C":"FR","ST":"France","L":"Guyancourt","O":"Silicom","CN":"*.camera2.silicom.com","days_validity":"360","dns":"camera2.silicom.com"} },
                                                    {"name":"install_virtual_camera", "args": {"video_url": "https://www.c-mor.com/video-surveillance-demo/sample-recordings-of-the-video-surveillance-system-c-mor?download=27:motion-detection-entrance-area"}},
                                                    {"name":"install_motion", "args": {"motion_port":"8081", "security":{}}}
                                                    ] },
        { "hostname": "camera3", "actions": [
                                                    {"name":"generate_certificates", "args": {"ca_holder":"dns","ca_name":"caroot.com","middle_holder":"dns","middle_name":"silicom.com","private_key_certificate_name":"camera3.silicom.com","bits":"2048","version":"2","serial":"","C":"FR","ST":"France","L":"Guyancourt","O":"Silicom","CN":"*.camera3.silicom.com","days_validity":"360","dns":"camera3.silicom.com"} },
                                                    {"name":"install_virtual_camera", "args": {"video_url": "https://www.c-mor.com/video-surveillance-demo/sample-recordings-of-the-video-surveillance-system-c-mor?download=28:motion-detection-warehouse-door"}},
                                                    {"name":"install_motion", "args": {"motion_port":"8081", "security":{}}}
                                                    ] },
        { "hostname": "videoCenter", "actions": [ 
                                                    {"name":"generate_certificates", "args": {"ca_holder":"dns","ca_name":"caroot.com","middle_holder":"dns","middle_name":"silicom.com","private_key_certificate_name":"videoCenter.silicom.com","bits":"2048","version":"2","serial":"","C":"FR","ST":"France","L":"Guyancourt","O":"Silicom","CN":"*.videoCenter.silicom.com","days_validity":"360","dns":"videoCenter.silicom.com"} },
                                                    {"name":"install_zoneminder", "args": {"":""}},
                                                    {"name":"enable_ssl", "args": {"cert_path":"/certs/videoCenter.silicom.com/videoCenter.silicom.com.cert","key_path":"/certs/videoCenter.silicom.com/videoCenter.silicom.com.key","ca_dir":"/certs/videoCenter.silicom.com/","cas_path":["/certs/videoCenter.silicom.com/caroot.com.cert","/certs/videoCenter.silicom.com/silicom.com.cert"]} }
                                                    ] },
        { "hostname": "elk", "actions": [
                                                    {"name":"install", "args": {"module":"firefox"} },
                                                    {"name":"install_elk", "args": {"logstash":"true","elasticsearch":"false","kibana":"false",
                                                                                    "fqdn_host":"elk.silicom.com","ip_fqdn":"10.122.1.11",
                                                                                    "admin_name":"kadmin","admin_passwd":"kadmin123"} },
                                                    {"name":"add_nameserver", "args": {"nameserver_ip":"10.122.0.14"} }
                                                    ] },
        { "hostname": "workstation1", "actions": [  
                                                    {"name":"install", "args": {"module":"nano"} },
                                                    {"name":"ldap_client_config", "args": {"ldap_ip":"10.122.1.10", 
                                                                                            "base":"dc=silicom,dc=com", 
                                                                                            "uri":"uri ldap://silicom.com/", 
                                                                                            "ldap_admin":"cn=admin,dc=silicom,dc=com"} },
                                                    {"name":"rsyslog_client", "args": {"ip_log_server":"10.122.1.11","log_files":["authentication"]} },
                                                    {"name":"push_sim_user"},
                                                    {"name":"download_file", "args": {"host_manager_path":"/home/user/Documents/si_simulator/resolv.conf", "instance_path":"/etc/resolv.conf"}},
                                                    {"name":"add_nameserver", "args": {"nameserver_ip":"10.122.0.14"} }
                                                    ] },
        { "hostname": "workstation2", "actions": [  
                                                    {"name":"ldap_client_config", "args": {"ldap_ip":"10.122.1.10", 
                                                                                            "base":"dc=silicom,dc=com", 
                                                                                            "uri":"uri ldap://silicom.com/", 
                                                                                            "ldap_admin":"cn=admin,dc=silicom,dc=com"} },
                                                    {"name":"rsyslog_client", "args": {"ip_log_server":"10.122.1.11","log_files":["authentication"]} },
                                                    {"name":"push_sim_user"},
                                                    {"name":"clear_nameserver"},
                                                    {"name":"add_nameserver", "args": {"nameserver_ip":"10.122.0.14"} }
                                                    ] },
        { "hostname": "workstation3", "actions": [  
                                                    {"name":"ldap_client_config", "args": {"ldap_ip":"10.122.1.10", 
                                                                                            "base":"dc=silicom,dc=com", 
                                                                                            "uri":"uri ldap://silicom.com/", 
                                                                                            "ldap_admin":"cn=admin,dc=silicom,dc=com"} },
                                                    {"name":"rsyslog_client", "args": {"ip_log_server":"10.122.1.11","log_files":["authentication"]} },
                                                    {"name":"push_sim_user"},
                                                    {"name":"clear_nameserver"},
                                                    {"name":"add_nameserver", "args": {"nameserver_ip":"10.122.0.14"} }
                                                    ] },
        { "hostname": "workstation4", "actions": [  
                                                    {"name":"ldap_client_config", "args": {"ldap_ip":"10.122.1.10", 
                                                                                            "base":"dc=silicom,dc=com", 
                                                                                            "uri":"uri ldap://silicom.com/", 
                                                                                            "ldap_admin":"cn=admin,dc=silicom,dc=com"} },
                                                    {"name":"rsyslog_client", "args": {"ip_log_server":"10.122.1.11","log_files":["authentication"]} },
                                                    {"name":"push_sim_user"},
                                                    {"name":"clear_nameserver"},
                                                    {"name":"add_nameserver", "args": {"nameserver_ip":"10.122.0.14"} }
                                                    ] },
        { "hostname": "hacker", "actions": [  
                                                    {"name":"install", "args": {"module":"nmap"} },
                                                    {"name":"create_local_user", "args": {"username":"hacker","password":"hacker123"} },
                                                    {"name":"push_sim_user"},
                                                    {"name":"add_nameserver", "args": {"nameserver_ip":"10.122.0.14"} }
                                                    ] }
    ]
}
